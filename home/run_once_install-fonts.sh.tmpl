#!/bin/bash
# ABOUTME: One-time font installation script
# ABOUTME: Copies fonts from ~/.config/fonts to system font directory

set -e

FONT_SOURCE="$HOME/.config/fonts"

{{- if eq .chezmoi.os "darwin" }}
# macOS: Install to user Library
FONT_DEST="$HOME/Library/Fonts"
{{- else }}
# Linux: Install to XDG font directory
FONT_DEST="$HOME/.local/share/fonts"
{{- end }}

if [[ ! -d "$FONT_SOURCE" ]]; then
    echo "Font source directory not found: $FONT_SOURCE"
    exit 0
fi

echo "Installing fonts from $FONT_SOURCE to $FONT_DEST..."
mkdir -p "$FONT_DEST"

# Copy all font files
cp -n "$FONT_SOURCE"/*.otf "$FONT_DEST/" 2>/dev/null || true
cp -n "$FONT_SOURCE"/*.ttf "$FONT_DEST/" 2>/dev/null || true

{{- if eq .chezmoi.os "linux" }}
# Linux: Rebuild font cache
echo "Rebuilding font cache..."
fc-cache -fv "$FONT_DEST"
{{- end }}

echo "âœ… Fonts installed successfully"
